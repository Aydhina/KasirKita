<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Laporan Penjualan</title>
<style>
  body {
    font-family: monospace;
    font-size: 12px;
    padding: 20px;
  }

  h1, h2, h3 {
    text-align: center;
    margin: 0 0 8px 0;
  }

  .section {
    width: 320px;
    margin: 0 auto 40px auto;
    border: 1px dashed #000;
    padding: 10px;
    page-break-inside: avoid;
  }

  .info {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
  }

  .line {
    border-top: 1px dashed #000;
    margin: 8px 0;
  }

  .produk-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 4px;
  }

  .produk-item span:first-child {
    max-width: 180px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .total {
    display: flex;
    justify-content: space-between;
    font-weight: bold;
    margin-top: 6px;
  }

  .produk-table {
    width: 100%;
    margin-top: 6px;
  }

  .produk-table td {
    padding: 2px 0;
  }
</style>

</head>
<body>
  <h1>Laporan Penjualan</h1>

  <% penjualan.forEach((item, index) => { %>
    <div class="section">
      <h2>Penjualan <%= index + 1 %></h2>
      <p><strong>Nama Pelanggan:</strong> <%= item.pelanggan.nama %></p>
      <p><strong>Alamat:</strong> <%= item.pelanggan.alamat %></p>
      <p><strong>Telepon:</strong> <%= item.pelanggan.telepon %></p>
      <p><strong>Tanggal Order:</strong> <%= item.tanggal %></p>
      <p><strong>Total Biaya:</strong> Rp<%= item.total.toLocaleString("id-ID") %></p>

      <h3>Detail Produk</h3>
      <table>
        <thead>
          <tr>
            <th>No</th>
            <th>Nama Produk</th>
            <th>Harga</th>
            <th>Jumlah</th>
            <th>Subtotal</th>
          </tr>
        </thead>
       <tbody>
  <% if (item.detailProduk && item.detailProduk.length > 0) { %>
    <% item.detailProduk.forEach((produk, idx) => { %>
      <tr>
        <td><%= idx + 1 %></td>
        <td><%= produk.namaProduk %></td>
        <td>Rp<%= produk.harga.toLocaleString("id-ID") %></td>
        <td><%= produk.jumlah %></td>
        <td>Rp<%= produk.subtotal.toLocaleString("id-ID") %></td>
      </tr>
    <% }) %>
  <% } else { %>
    <tr>
      <td colspan="5" style="text-align: center;">Tidak ada produk</td>
    </tr>
  <% } %>
</tbody>

      </table>
    </div>
  <% }) %>
</body>
</html>
